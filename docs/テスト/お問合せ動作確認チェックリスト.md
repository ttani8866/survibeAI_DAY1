# お問合せ機能 動作確認チェックリスト

## 概要
お問合せフォーム機能（`/contact`）の動作確認用チェックリストです。

---

## 事前準備

- [ ] MongoDBが起動していること
- [ ] `.env.local` に環境変数が設定されていること
- [ ] 開発サーバーが起動していること（`pnpm dev`）

---

## 確認項目

### 1. お問合せフォーム画面の表示

| # | 確認内容 | 期待結果 | OK/NG |
|---|---------|---------|-------|
| 1-1 | `/contact` にアクセス | お問合せフォーム画面が表示される | |
| 1-2 | ヘッダーロゴ表示 | 「SurviveAI」ロゴが表示される | |
| 1-3 | フォームタイトル表示 | 「お問合せ」タイトルが表示される | |
| 1-4 | 入力フィールド表示 | 名前、メールアドレス、件名、本文の4つのフィールドが表示される | |
| 1-5 | 送信ボタン表示 | 「送信する」ボタンが表示される | |
| 1-6 | レスポンシブ対応 | モバイル幅でも正しくレイアウトされる | |

---

### 2. 必須項目の未入力時エラー表示

| # | 確認内容 | 期待結果 | OK/NG |
|---|---------|---------|-------|
| 2-1 | 全項目未入力で送信 | 各フィールドにエラーメッセージが表示される | |
| 2-2 | 名前のみ未入力で送信 | 「名前を入力してください」エラーが表示される | |
| 2-3 | メールアドレスのみ未入力で送信 | 「メールアドレスを入力してください」エラーが表示される | |
| 2-4 | 件名のみ未入力で送信 | 「件名を入力してください」エラーが表示される | |
| 2-5 | 本文のみ未入力で送信 | 「本文を入力してください」エラーが表示される | |
| 2-6 | エラー後に入力 | 入力するとエラーメッセージが消える | |

---

### 3. メールアドレス形式エラー表示

| # | 確認内容 | 期待結果 | OK/NG |
|---|---------|---------|-------|
| 3-1 | 「test」と入力して送信 | 「有効なメールアドレスを入力してください」エラーが表示される | |
| 3-2 | 「test@」と入力して送信 | 「有効なメールアドレスを入力してください」エラーが表示される | |
| 3-3 | 「test@example」と入力して送信 | 「有効なメールアドレスを入力してください」エラーが表示される | |
| 3-4 | 「test@example.com」と入力して送信 | エラーが表示されない | |
| 3-5 | 「user.name+tag@example.co.jp」と入力して送信 | エラーが表示されない | |

---

### 4. 送信成功時の完了画面表示

| # | 確認内容 | 期待結果 | OK/NG |
|---|---------|---------|-------|
| 4-1 | 全項目を正しく入力して送信 | ローディング表示（「送信中...」）が表示される | |
| 4-2 | 送信完了後 | 完了画面が表示される | |
| 4-3 | 完了画面の内容 | チェックアイコン、「送信完了」タイトルが表示される | |
| 4-4 | 完了メッセージ | 「お問合せありがとうございます。内容を確認次第、ご連絡いたします。」が表示される | |
| 4-5 | トップページリンク | 「トップページに戻る」ボタンが表示される | |
| 4-6 | トップページリンククリック | トップページ（`/`）に遷移する | |

---

### 5. 管理者へのメール受信確認

| # | 確認内容 | 期待結果 | OK/NG |
|---|---------|---------|-------|
| 5-1 | お問合せ送信後 | `ADMIN_EMAIL` に設定したアドレスにメールが届く | |
| 5-2 | メール件名 | 「【お問合せ】{件名}」形式で表示される | |
| 5-3 | メール本文（テキスト） | 名前、メールアドレス、件名、本文、送信日時が含まれる | |
| 5-4 | メール本文（HTML） | テーブル形式で整形された内容が表示される | |
| 5-5 | 送信元アドレス | `SMTP_USER` に設定したアドレスが表示される | |

> **注意**: SMTP環境変数が未設定の場合、メール送信はスキップされます（DB保存は行われます）

---

### 6. MongoDBへのデータ保存確認

| # | 確認内容 | 期待結果 | OK/NG |
|---|---------|---------|-------|
| 6-1 | お問合せ送信後 | `contacts` コレクションにドキュメントが追加される | |
| 6-2 | nameフィールド | 入力した名前が保存されている | |
| 6-3 | emailフィールド | 入力したメールアドレスが小文字で保存されている | |
| 6-4 | subjectフィールド | 入力した件名が保存されている | |
| 6-5 | messageフィールド | 入力した本文が保存されている | |
| 6-6 | createdAtフィールド | 送信日時が自動的に保存されている | |

#### MongoDB確認コマンド例
```javascript
// MongoDB Shellで確認
use survibe
db.contacts.find().sort({ createdAt: -1 }).limit(5).pretty()
```

---

## テスト実施記録

| 項目 | 実施日 | 実施者 | 結果 | 備考 |
|------|-------|-------|------|------|
| 1. フォーム画面表示 | | | | |
| 2. 必須項目エラー | | | | |
| 3. メール形式エラー | | | | |
| 4. 完了画面表示 | | | | |
| 5. メール受信確認 | | | | |
| 6. DB保存確認 | | | | |

---

## 備考・特記事項

- 

